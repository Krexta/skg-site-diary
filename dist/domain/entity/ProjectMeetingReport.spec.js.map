{"version":3,"sources":["../../../src/domain/entity/ProjectMeetingReport.spec.ts"],"sourcesContent":["import { format } from 'date-fns';\nimport fc from 'fast-check';\nimport { describe, expect, it } from 'vitest';\n\nimport {\n  CreateUserId,\n  FileName,\n  FilePath,\n  ProjectId,\n  ProjectReportId,\n  ReportText,\n  Title,\n  UploadUserId,\n  YEAR_MONTH_DAY_FORMAT,\n  YearMonthDay,\n} from '../value';\nimport { MAX_FILE_NAME_LENGTH } from '../value/String/BaseString';\n\nimport {\n  File,\n  IProjectMeetingReport,\n  IUpdateProjectMeetingReport,\n  ProjectMeetingReport,\n  UpdateProjectMeetingReport,\n} from '.';\n\nfunction makeCreateProperty() {\n  return fc\n    .record({\n      id: fc.uuid({ version: 7 }),\n      createUserId: fc.uuid({ version: 7 }),\n      reportDate: fc\n        .date({\n          min: new Date(0, 0, 0, 0, 0, 0),\n          max: new Date(9998, 12, 31, 23, 59, 59),\n        })\n        .map((val) => format(val, YEAR_MONTH_DAY_FORMAT)),\n      projectId: fc.uuid({ version: 7 }),\n      files: fc.array(\n        fc.record({\n          name: fc\n            .string({ minLength: 1, maxLength: MAX_FILE_NAME_LENGTH })\n            .map((val) => val.trim())\n            .filter((val) => val.length >= 1),\n          path: fc.webUrl(),\n          uploadUserId: fc.uuid({ version: 7 }),\n        }),\n        { minLength: 1 },\n      ),\n      title: fc\n        .string({ minLength: 1 })\n        .map((val) => val.trim())\n        .filter((val) => val.length >= 1),\n      reportText: fc\n        .string({ minLength: 1 })\n        .map((val) => val.trim())\n        .filter((val) => val.length >= 1),\n    })\n    .map<IProjectMeetingReport>(\n      ({\n        id,\n        createUserId,\n        reportDate,\n        projectId,\n        files,\n        title,\n        reportText,\n      }) => ({\n        id: ProjectReportId.from(id),\n        createUserId: CreateUserId.from(createUserId),\n        reportDate: YearMonthDay.from(reportDate),\n        projectId: ProjectId.from(projectId),\n        files: files.map(\n          (file) =>\n            new File({\n              name: FileName.from(file.name),\n              path: FilePath.from(file.path),\n              uploadUserId: UploadUserId.from(file.uploadUserId),\n            }),\n        ),\n        title: Title.from(title),\n        reportText: ReportText.from(reportText),\n      }),\n    );\n}\nfunction makeUpdateProperty() {\n  return fc\n    .record({\n      createUserId: fc.option(fc.uuid({ version: 7 }), { nil: undefined }),\n      reportDate: fc.option(\n        fc\n          .date({\n            min: new Date(0, 0, 0, 0, 0, 0),\n            max: new Date(9998, 12, 31, 23, 59, 59),\n          })\n          .map((val) => format(val, YEAR_MONTH_DAY_FORMAT)),\n        { nil: undefined },\n      ),\n      projectId: fc.option(fc.uuid({ version: 7 }), { nil: undefined }),\n      files: fc.option(\n        fc.array(\n          fc.record({\n            name: fc\n              .string({ minLength: 1, maxLength: MAX_FILE_NAME_LENGTH })\n              .map((val) => val.trim())\n              .filter((val) => val.length >= 1),\n            path: fc.webUrl(),\n            uploadUserId: fc.uuid({ version: 7 }),\n          }),\n          { minLength: 1 },\n        ),\n        { nil: undefined },\n      ),\n      title: fc.option(\n        fc\n          .string({ minLength: 1 })\n          .map((val) => val.trim())\n          .filter((val) => val.length >= 1),\n        { nil: undefined },\n      ),\n      reportText: fc.option(\n        fc\n          .string({ minLength: 1 })\n          .map((val) => val.trim())\n          .filter((val) => val.length >= 1),\n        { nil: undefined },\n      ),\n    })\n    .map<IUpdateProjectMeetingReport>(\n      ({ createUserId, reportDate, projectId, files, title, reportText }) => ({\n        createUserId: createUserId\n          ? CreateUserId.from(createUserId)\n          : undefined,\n        reportDate: reportDate ? YearMonthDay.from(reportDate) : undefined,\n        projectId: projectId ? ProjectId.from(projectId) : undefined,\n        files: files?.map(\n          (file) =>\n            new File({\n              name: FileName.from(file.name),\n              path: FilePath.from(file.path),\n              uploadUserId: UploadUserId.from(file.uploadUserId),\n            }),\n        ),\n        title: title ? Title.from(title) : undefined,\n        reportText: reportText ? ReportText.from(reportText) : undefined,\n      }),\n    );\n}\n\ndescribe('ProjectMeetingReport', () => {\n  it('should return ProjectMeetingReport when input is valid', () => {\n    fc.assert(\n      fc.property(makeCreateProperty(), (args) => {\n        const entity = new ProjectMeetingReport(args);\n        expect(entity).toBeInstanceOf(ProjectMeetingReport);\n\n        expect(entity.id.value).toEqual(args.id.value);\n        expect(entity.createUserId.value).toEqual(args.createUserId.value);\n        expect(entity.reportDate.toString()).toEqual(\n          args.reportDate.toString(),\n        );\n        expect(entity.projectId.value).toEqual(args.projectId.value);\n        expect(entity.files).toEqual(expect.arrayContaining(args.files));\n        expect(entity.title.value).toEqual(args.title.value);\n        expect(entity.reportText.value).toEqual(args.reportText.value);\n      }),\n    );\n  });\n  describe('update', () => {\n    it('should return UpdateProjectMeetingReport when input is valid', () => {\n      fc.assert(\n        fc.property(\n          fc.record({\n            createArgs: makeCreateProperty(),\n            updateArgs: makeUpdateProperty(),\n          }),\n          ({ createArgs, updateArgs }) => {\n            const entity = new ProjectMeetingReport(createArgs);\n            expect(entity).toBeInstanceOf(ProjectMeetingReport);\n\n            const update = entity.update(updateArgs);\n            expect(update).toBeInstanceOf(UpdateProjectMeetingReport);\n            expect(update.id.value).toEqual(entity.id.value);\n            expect(update.createUserId?.value).toEqual(\n              updateArgs.createUserId?.value,\n            );\n            expect(update.reportDate?.toString()).toEqual(\n              updateArgs.reportDate?.toString(),\n            );\n            if (updateArgs.files) {\n              expect(update.files).toEqual(\n                expect.arrayContaining(updateArgs.files),\n              );\n            } else {\n              expect(update.files).toBeUndefined();\n            }\n            expect(update.title?.value).toEqual(updateArgs.title?.value);\n            expect(update.reportText?.value).toEqual(\n              updateArgs.reportText?.value,\n            );\n          },\n        ),\n      );\n    });\n  });\n});\n"],"names":["format","fc","describe","expect","it","CreateUserId","FileName","FilePath","ProjectId","ProjectReportId","ReportText","Title","UploadUserId","YEAR_MONTH_DAY_FORMAT","YearMonthDay","MAX_FILE_NAME_LENGTH","File","ProjectMeetingReport","UpdateProjectMeetingReport","makeCreateProperty","record","id","uuid","version","createUserId","reportDate","date","min","Date","max","map","val","projectId","files","array","name","string","minLength","maxLength","trim","filter","length","path","webUrl","uploadUserId","title","reportText","from","file","makeUpdateProperty","option","nil","undefined","assert","property","args","entity","toBeInstanceOf","value","toEqual","toString","arrayContaining","createArgs","updateArgs","update","toBeUndefined"],"mappings":"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"}